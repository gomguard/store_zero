<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quick Biz Preview (Unsan Networks)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        .tooltip-container { position: relative; display: inline-flex; align-items: center; margin-left: 0.5rem; }
        .tooltip-text {
            visibility: hidden; opacity: 0; transition: opacity 0.2s;
            position: absolute; bottom: 100%; left: 50%; transform: translateX(-50%);
            margin-bottom: 0.5rem; width: 16rem; padding: 0.5rem;
            background-color: #1e293b; color: white; font-size: 0.75rem; font-weight: normal;
            border-radius: 0.375rem; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            z-index: 50; pointer-events: none; text-align: center; line-height: 1.4;
        }
        .tooltip-text::after {
            content: " "; position: absolute; top: 100%; left: 50%; margin-left: -5px;
            border-width: 5px; border-style: solid; border-color: #1e293b transparent transparent transparent;
        }
        .tooltip-container:hover .tooltip-text { visibility: visible; opacity: 1; }
        .modal { transition: opacity 0.25s ease; }
        body.modal-active { overflow-x: hidden; overflow-y: visible !important; }
        .custom-scroll::-webkit-scrollbar { width: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: #f1f1f1; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
    </style>
</head>
<body class="bg-gray-50 text-gray-900 antialiased py-8 px-4 flex flex-col min-h-screen">

    <div class="max-w-5xl mx-auto space-y-8 flex-grow w-full">
        
        <div class="flex justify-between items-end border-b border-gray-200 pb-4">
            <div>
                <h1 class="text-2xl font-bold tracking-tight text-gray-900">Quick Biz Preview <span class="text-indigo-600 text-lg font-medium">(Final)</span></h1>
                <p class="text-sm text-gray-500 mt-1">ì‹¤ì „ ì°½ì—… íƒ€ë‹¹ì„± ê²€í†  & ëª©í‘œ ë§¤ì¶œ ê³„ì‚°ê¸°</p>
            </div>
            <div class="text-xs text-gray-400 font-mono text-right">Ver 10.7<br>Unsan Networks</div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 items-start">
            
            <div class="space-y-6">
                <div class="bg-slate-800 rounded-lg shadow-lg border border-slate-700 p-6 text-white relative overflow-hidden">
                    <div class="absolute top-0 right-0 -mr-16 -mt-16 w-64 h-64 rounded-full bg-slate-700 opacity-20 blur-3xl pointer-events-none"></div>
                    <h2 class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-4 flex items-center relative z-10">
                        1. ëª©í‘œ ìˆœìˆ˜ìµ (ì„¸í›„)
                        <div class="tooltip-container">
                            <svg class="w-4 h-4 text-slate-400 cursor-help" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            <div class="tooltip-text bg-white text-slate-900 border border-gray-200">
                                ì›”ì„¸, ì§ì› ì›”ê¸‰, ë¶€ê°€ì„¸, ì†Œë“ì„¸ ë“±<br><b>ëª¨ë“  ë¹„ìš©ì„ ë‹¤ ë‚´ê³  ì‚¬ì¥ë‹˜ì´ ê°€ì ¸ê°€ëŠ” ìˆœìˆ˜ í˜„ê¸ˆ</b>ì…ë‹ˆë‹¤.
                            </div>
                        </div>
                    </h2>
                    <div class="mb-5 relative z-10">
                        <div class="relative">
                            <input type="text" id="targetProfit" value="10,000,000" class="block w-full bg-slate-700 border-0 rounded-md py-3 pl-3 pr-10 text-white font-bold text-2xl text-right ring-1 ring-slate-600 focus:ring-2 focus:ring-indigo-500 transition-all calc-trigger">
                            <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center pr-4"><span class="text-slate-400 text-sm">ì›</span></div>
                        </div>
                    </div>
                    <div class="bg-slate-700/50 rounded-md p-3 text-xs space-y-2 border border-slate-600 relative z-10">
                        <div class="flex justify-between"><span>ì—°ê°„ í™˜ì‚° ì†Œë“</span><span id="displayAnnualIncome" class="text-slate-200 font-medium">0 ì›</span></div>
                        <div class="flex justify-between">
                            <div class="flex items-center"><span class="text-slate-400 mr-2">ì ìš© ëˆ„ì§„ì„¸ìœ¨</span><button onclick="toggleModal()" class="text-[10px] bg-slate-600 px-1.5 rounded hover:bg-slate-500">ì„¸ìœ¨í‘œ</button></div>
                            <span id="displayTaxBracket" class="text-yellow-400 font-bold">...</span>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-5">
                    <h2 class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-4 flex items-center">
                        2. ì›” ê³ ì •ë¹„ (VAT í¬í•¨ ì…ë ¥)
                        <div class="tooltip-container">
                            <svg class="w-4 h-4 text-gray-400 cursor-help" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            <div class="tooltip-text">ë§¤ì¶œì´ 0ì›ì´ì–´ë„ ë§¤ë‹¬ ë°˜ë“œì‹œ ë‚˜ê°€ëŠ” ëˆì…ë‹ˆë‹¤.<br>(ì›”ì„¸, ê´€ë¦¬ë¹„, í†µì‹ ë¹„, ê´‘ê³ ë¹„ ë“±)</div>
                        </div>
                    </h2>
                    <div class="grid grid-cols-2 gap-4">
                        <div><label class="block text-xs font-medium text-gray-500 mb-1">ì›”ì„¸/ê´€ë¦¬ë¹„</label><input type="text" id="rent" value="1,650,000" class="input-currency block w-full rounded-md border-0 py-1.5 pl-3 pr-3 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-black sm:text-sm bg-gray-50 text-right calc-trigger"></div>
                        <div><label class="block text-xs font-medium text-gray-500 mb-1">ê¸°íƒ€ ìš´ì˜ë¹„</label><input type="text" id="misc" value="1,650,000" class="input-currency block w-full rounded-md border-0 py-1.5 pl-3 pr-3 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-black sm:text-sm bg-gray-50 text-right calc-trigger"></div>
                    </div>
                </div>

                <div class="bg-indigo-50 rounded-lg shadow-sm border border-indigo-100 p-5">
                    <h2 class="text-xs font-bold text-indigo-800 uppercase tracking-wider mb-4 flex items-center">
                        3. ê¸ˆìœµ ë¹„ìš© (ëŒ€ì¶œ ì´ì)
                        <div class="tooltip-container">
                            <svg class="w-4 h-4 text-indigo-400 cursor-help" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            <div class="tooltip-text bg-indigo-900 text-white border-0">
                                ì›ê¸ˆ ìƒí™˜ì•¡ì€ ë¹„ìš©ì´ ì•„ë‹™ë‹ˆë‹¤.<br>ì˜¤ì§ <b>ì´ì ë¹„ìš©</b>ë§Œ ë¹„ìš© ì²˜ë¦¬ë˜ì–´ ì„¸ê¸ˆì„ ì¤„ì—¬ì¤ë‹ˆë‹¤.
                            </div>
                        </div>
                    </h2>
                    <div class="grid grid-cols-2 gap-4">
                        <div><label class="block text-xs font-medium text-indigo-600 mb-1">ëŒ€ì¶œ ì›ê¸ˆ</label><input type="text" id="loanPrincipal" value="100,000,000" class="block w-full rounded-md border-0 py-1.5 pl-3 pr-3 text-indigo-900 ring-1 ring-inset ring-indigo-200 focus:ring-2 focus:ring-indigo-500 sm:text-sm text-right font-bold calc-trigger"></div>
                        
                        <div>
                            <label class="block text-xs font-medium text-indigo-600 mb-1">ì—° ì´ììœ¨ (%)</label>
                            <input type="text" id="loanRate" value="4.5" inputmode="decimal" class="block w-full rounded-md border-0 py-1.5 pl-3 pr-3 text-indigo-900 ring-1 ring-inset ring-indigo-200 focus:ring-2 focus:ring-indigo-500 sm:text-sm text-right font-bold calc-trigger">
                        </div>
                    </div>
                    <div class="mt-2 text-right text-xs text-indigo-500 font-medium">ì˜ˆìƒ ì›” ì´ì: <span id="monthlyInterestDisplay">0ì›</span></div>
                </div>
            </div>

            <div class="space-y-6">
                <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden flex flex-col" style="max-height: 400px;">
                    <div class="px-5 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50 flex-shrink-0">
                        <div>
                            <h2 class="text-xs font-bold text-gray-500 uppercase tracking-wider flex items-center">
                                4. ì¸ê±´ë¹„ (ì§ì›ë§Œ)
                                <div class="tooltip-container">
                                    <svg class="w-4 h-4 text-gray-400 cursor-help" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                    <div class="tooltip-text">
                                        <b>ì ì¥/ì§ì› ê¸‰ì—¬</b>ì…ë‹ˆë‹¤.<br>ëŒ€í‘œë‹˜ì˜ ì¸ê±´ë¹„ëŠ” 'ëª©í‘œ ìˆœìˆ˜ìµ'ì— í¬í•¨ë˜ë¯€ë¡œ ì—¬ê¸°ì„œëŠ” ì œì™¸í•˜ì„¸ìš”.
                                    </div>
                                </div>
                            </h2>
                            <p class="text-[10px] text-gray-400 mt-0.5">íšŒì‚¬ë¶€ë‹´ 4ëŒ€ë³´í—˜(10.7%) ìë™ í•©ì‚°</p>
                        </div>
                        <button onclick="addLaborRow()" class="text-xs font-medium text-blue-600 hover:text-blue-800 bg-blue-50 px-3 py-1.5 rounded border border-blue-100">+ ì¸ì› ì¶”ê°€</button>
                    </div>
                    
                    <div class="p-5 overflow-y-auto custom-scroll flex-grow">
                        <table class="w-full text-sm" id="laborTable">
                            <tbody class="divide-y divide-gray-50" id="laborBody">
                                <tr>
                                    <td class="py-2"><input type="text" value="ì ì¥" class="w-full border-0 p-0 text-gray-900 text-sm font-medium"></td>
                                    <td class="py-2"><input type="text" value="3,000,000" class="input-currency w-full border-0 p-0 text-gray-900 text-sm bg-gray-50 rounded px-2 text-right calc-trigger"></td>
                                    <td class="py-2"><input type="number" value="1" class="w-full border-0 p-0 text-gray-900 text-sm bg-gray-50 rounded px-2 text-right calc-trigger"></td>
                                    <td class="text-right"><button onclick="removeRow(this)" class="text-gray-300 hover:text-red-500">Ã—</button></td>
                                </tr>
                            </tbody>
                        </table>
                        
                        <div class="mt-4 pt-3 border-t border-dashed border-gray-200 space-y-1">
                            <div class="flex justify-between text-xs text-gray-500"><span>ìˆœìˆ˜ ê¸‰ì—¬ í•©ê³„</span><span id="displayBaseSalary">0ì›</span></div>
                            <div class="flex justify-between text-xs text-red-500 font-bold"><span>(+) 4ëŒ€ë³´í—˜ (íšŒì‚¬ë¶€ë‹´ë¶„)</span><span id="displayInsurance">0ì›</span></div>
                            <div class="flex justify-between text-sm font-bold text-gray-900 pt-1 border-t border-gray-100"><span>ì´ ì¸ê±´ë¹„ ì§€ì¶œ</span><span id="totalLaborPreview">0ì›</span></div>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden flex flex-col" style="max-height: 400px;">
                    <div class="px-5 py-3 border-b border-gray-100 flex justify-between items-center bg-gray-50 flex-shrink-0">
                        <h2 class="text-xs font-bold text-gray-500 uppercase tracking-wider flex items-center">
                            5. ìƒí’ˆ ì„¤ê³„ (VAT í¬í•¨)
                            <div class="tooltip-container">
                                <svg class="w-4 h-4 text-gray-400 cursor-help" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                <div class="tooltip-text">
                                    ê³ ê°ì—ê²Œ ë°›ëŠ” <b>íŒë§¤ê°€</b>ì™€<br>ê³µì¥ì— ì£¼ëŠ” <b>ì›ê°€</b>ë¥¼ ì…ë ¥í•˜ì„¸ìš”.<br>ë¶€ê°€ì„¸ëŠ” ìë™ìœ¼ë¡œ ë°œë¼ëƒ…ë‹ˆë‹¤.
                                </div>
                            </div>
                        </h2>
                        <button onclick="addProductRow()" class="text-xs font-medium text-blue-600 hover:text-blue-800 bg-blue-50 px-3 py-1.5 rounded border border-blue-100">+ ìƒí’ˆ ì¶”ê°€</button>
                    </div>
                    
                    <div class="p-5 overflow-y-auto custom-scroll flex-grow">
                        <table class="w-full text-sm" id="productTable">
                            <thead>
                                <tr class="text-xs text-gray-400 border-b border-gray-100">
                                    <th class="text-left pb-2 font-medium w-1/3">í•­ëª©ëª…</th>
                                    <th class="text-right pb-2 font-medium">íŒë§¤ê°€(P)</th>
                                    <th class="text-right pb-2 font-medium">ì›ê°€(C)</th>
                                    <th class="text-right pb-2 font-medium">ë¹„ì¤‘</th>
                                    <th class="w-8"></th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-50" id="productBody">
                                <tr>
                                    <td class="py-3 pr-2"><input type="text" value="í•©ì„± ì—”ì§„ì˜¤ì¼" class="w-full border-0 p-0 text-gray-900 font-medium"></td>
                                    <td class="py-3 px-1"><input type="text" value="110,000" class="input-currency w-full border-0 p-0 text-gray-900 bg-blue-50 rounded px-1 text-right calc-trigger"></td>
                                    <td class="py-3 px-1"><input type="text" value="55,000" class="input-currency w-full border-0 p-0 text-gray-900 bg-red-50 rounded px-1 text-right calc-trigger"></td>
                                    <td class="py-3 pl-2"><input type="number" value="75" class="mix-percent w-full border-0 p-0 text-indigo-700 font-bold bg-gray-100 rounded px-1 text-right calc-trigger"></td>
                                    <td class="text-right"><button onclick="removeRow(this)" class="text-gray-300 hover:text-red-500">Ã—</button></td>
                                </tr>
                                <tr>
                                    <td class="py-3 pr-2"><input type="text" value="íƒ€ì´ì–´(1ì§)" class="w-full border-0 p-0 text-gray-900 font-medium"></td>
                                    <td class="py-3 px-1"><input type="text" value="154,000" class="input-currency w-full border-0 p-0 text-gray-900 bg-blue-50 rounded px-1 text-right calc-trigger"></td>
                                    <td class="py-3 px-1"><input type="text" value="110,000" class="input-currency w-full border-0 p-0 text-gray-900 bg-red-50 rounded px-1 text-right calc-trigger"></td>
                                    <td class="py-3 pl-2"><input type="number" value="25" class="mix-percent w-full border-0 p-0 text-indigo-700 font-bold bg-gray-100 rounded px-1 text-right calc-trigger"></td>
                                    <td class="text-right"><button onclick="removeRow(this)" class="text-gray-300 hover:text-red-500">Ã—</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="bg-gray-50 px-5 py-3 border-t border-gray-100 flex justify-end items-center flex-shrink-0">
                        <span class="text-xs text-gray-500 mr-2">í˜„ì¬ ë¹„ì¤‘ í•©ê³„:</span><span id="mixTotalDisplay" class="text-sm font-bold text-green-600 transition-colors">100%</span>
                    </div>
                </div>
            </div>
        </div>

        <div id="resultBox" class="hidden mt-8 animate-fade-in">
            <div class="bg-white border-2 border-indigo-600 rounded-xl shadow-xl overflow-hidden">
                <div class="bg-indigo-600 px-6 py-4 flex justify-between items-center text-white">
                    <h3 class="font-bold text-lg">ğŸ“Š ì‹œë®¬ë ˆì´ì…˜ ë¶„ì„ ê²°ê³¼</h3>
                    <div class="text-xs opacity-80 bg-indigo-700 px-2 py-1 rounded">2024 ê³¼ì„¸í‘œì¤€ + 4ëŒ€ë³´í—˜ ë°˜ì˜</div>
                </div>
                <div class="p-6 md:p-8 grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-10">
                    <div>
                        <h4 class="text-sm font-bold text-gray-500 uppercase tracking-wider mb-4 border-b pb-2">ìˆ˜ìµ êµ¬ì¡° ë¶„ì„ (ì›” ê¸°ì¤€)</h4>
                        <div class="space-y-4 text-sm">
                            <div class="flex flex-col md:flex-row md:justify-between md:items-center gap-1 md:gap-0">
                                <span class="text-gray-600">â‘  ëª©í‘œ ì„¸í›„ ìˆœì´ìµ</span>
                                <span id="resTargetNet" class="font-bold text-lg text-gray-900">0 ì›</span>
                            </div>
                            <div class="flex flex-col md:flex-row md:justify-between md:items-center gap-1 md:gap-0">
                                <span class="text-gray-500">â‘¡ ì˜ˆìƒ ì†Œë“ì„¸ (ëˆ„ì§„ì„¸)</span>
                                <span id="resIncomeTax" class="text-red-500 font-medium">+ 0 ì›</span>
                            </div>
                            <div class="flex flex-col md:flex-row md:justify-between md:items-center pt-2 border-t border-dashed border-gray-200 gap-1 md:gap-0">
                                <span class="text-gray-600 font-medium">â‘¢ í•„ìš” ì˜ì—…ì´ìµ (ì„¸ì „)</span>
                                <span id="resPreTaxProfit" class="font-bold text-indigo-900">0 ì›</span>
                            </div>
                            
                            <div class="bg-gray-50 p-3 rounded mt-2 space-y-2">
                                <div class="flex flex-col md:flex-row md:justify-between md:items-center text-gray-600 text-xs gap-1 md:gap-0">
                                    <span>ì›” ê³ ì •ë¹„ (ì„ëŒ€ë£Œ ë“±)</span><span id="resBasicFixed">0 ì›</span>
                                </div>
                                <div class="flex flex-col md:flex-row md:justify-between md:items-center text-gray-600 text-xs gap-1 md:gap-0">
                                    <span>ê¸ˆìœµë¹„ìš© (ëŒ€ì¶œì´ì)</span><span id="resFinanceFixed">0 ì›</span>
                                </div>
                                <div class="border-t border-gray-200 pt-2 space-y-2">
                                    <div class="flex flex-col md:flex-row md:justify-between md:items-center text-gray-600 text-xs gap-1 md:gap-0">
                                        <span>ì¸ê±´ë¹„ (ì§€ê¸‰ ê¸‰ì—¬)</span><span id="resLaborBase">0 ì›</span>
                                    </div>
                                    <div class="flex flex-col md:flex-row md:justify-between md:items-center text-red-600 text-xs font-bold gap-1 md:gap-0">
                                        <span>(+) 4ëŒ€ë³´í—˜ (íšŒì‚¬ë¶€ë‹´ë¶„)</span><span id="resLaborInsurance">0 ì›</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="flex flex-col md:flex-row md:justify-between md:items-center bg-indigo-50 p-3 rounded-lg mt-2 gap-2 md:gap-0">
                                <span class="font-bold text-indigo-800 flex items-center">
                                    â‘£ í•„ìš” ê³µí—Œì´ìµ Total
                                    <div class="tooltip-container">
                                        <svg class="w-4 h-4 text-indigo-400 cursor-help" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                        <div class="tooltip-text bg-indigo-900 text-white">
                                            ê³ ì •ë¹„ì™€ ì¸ê±´ë¹„ë¥¼ ëª¨ë‘ ê°šê³ ë„<br>ëª©í‘œ ì´ìµì„ ë‚¨ê¸°ê¸° ìœ„í•´ ë²Œì–´ì•¼ í• <br><b>'ë§¤ì¶œ - ì¬ë£Œë¹„'ì˜ ì´ì•¡</b>ì…ë‹ˆë‹¤.
                                        </div>
                                    </div>
                                </span>
                                <span id="resContribution" class="font-bold text-indigo-800 text-base whitespace-nowrap">0 ì›</span>
                            </div>
                        </div>
                        
                        <div class="mt-6 border-t border-gray-200 pt-3 space-y-2">
                            <div class="flex flex-col md:flex-row md:justify-between text-xs text-gray-500 gap-1 md:gap-0">
                                <span>ëª©í‘œ ë§¤ì¶œ (ê³µê¸‰ê°€ì•¡)</span>
                                <span id="resRevenueSupply" class="font-medium">0 ì›</span>
                            </div>
                            <div class="flex flex-col md:flex-row md:justify-between text-xs text-gray-500 gap-1 md:gap-0">
                                <span>(+) ì˜ˆìƒ ë¶€ê°€ì„¸ (10%)</span>
                                <span id="resRevenueVAT" class="font-medium">0 ì›</span>
                            </div>
                            <div class="bg-indigo-50 rounded-lg p-4 text-center mt-3">
                                <div class="text-xs text-indigo-600 mb-1 font-bold">ìµœì¢… ëª©í‘œ ì›” ë§¤ì¶œì•¡ (VAT í¬í•¨)</div>
                                <div id="resTotalRevenue" class="text-2xl md:text-3xl font-extrabold text-indigo-700 tracking-tight">0 ì›</div>
                            </div>
                        </div>
                    </div>
                    <div class="bg-gray-50 rounded-xl p-6 border border-gray-100">
                        <h4 class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-4">ì¼ì¼ íŒë§¤ ëª©í‘œ (25ì¼ ê·¼ë¬´)</h4>
                        <div id="dailyTargets" class="space-y-3"></div>
                        <div class="mt-6 p-3 bg-white rounded border border-gray-200 text-xs text-gray-500 leading-relaxed">ğŸ’¡ <b>Boss Tip:</b><br>ì…ë ¥ëœ ì¸ê±´ë¹„ëŠ” <b>ìˆœìˆ˜ ì§ì› ê¸‰ì—¬</b>ì…ë‹ˆë‹¤. ëŒ€í‘œë‹˜ì˜ ì¸ê±´ë¹„ëŠ” <b>â‘ ëª©í‘œ ìˆœìˆ˜ìµ</b>ì— í¬í•¨ë˜ì–´ ìˆìœ¼ë‹ˆ í˜¼ë™í•˜ì§€ ë§ˆì„¸ìš”.</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="border-t border-gray-200 pt-6 pb-2 text-center">
            <p class="text-[11px] text-gray-400 leading-relaxed mb-4"><b>[ë©´ì±… ì¡°í•­]</b> ë³¸ ì‹œë®¬ë ˆì´í„°ëŠ” ì´ˆê¸° ì‚¬ì—… íƒ€ë‹¹ì„± ê²€í† ë¥¼ ìœ„í•œ <b>ê°„ì´ ê³„ì‚° ë„êµ¬(Lite Tool)</b>ì…ë‹ˆë‹¤.<br>4ëŒ€ë³´í—˜ì€ í¸ì˜ìƒ ì „ ì§ì› 10.7% ì¼ê´„ ì ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.<br>ì •í™•í•œ ì¬ë¬´ ì„¤ê³„ ë° ì„¸ë¬´ ì‹ ê³ ëŠ” ë°˜ë“œì‹œ <b>ì„¸ë¬´ì‚¬, íšŒê³„ì‚¬ ë“± ì „ë¬¸ê°€ì™€ ìƒì˜í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.</b></p>
            
            <div class="mt-4 text-center">
                <span class="text-xs text-black font-bold tracking-widest uppercase">Powered by (ì£¼)ìš´ì‚°ë„¤íŠ¸ì›ìŠ¤</span>
            </div>
        </div>
    </div>

    <div id="taxModal" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center z-50">
        <div class="modal-overlay absolute w-full h-full bg-gray-900 opacity-50" onclick="toggleModal()"></div>
        <div class="modal-container bg-white w-11/12 md:max-w-md mx-auto rounded shadow-lg z-50 overflow-y-auto">
            <div class="modal-content py-4 text-left px-6">
                <div class="flex justify-between items-center pb-3 border-b"><p class="text-lg font-bold text-indigo-900">2024ë…„ ê·€ì† ì¢…í•©ì†Œë“ì„¸ìœ¨í‘œ</p><div class="modal-close cursor-pointer" onclick="toggleModal()">âœ–</div></div>
                <div class="my-4"><table class="w-full text-xs text-left text-gray-500"><thead class="text-xs text-gray-700 uppercase bg-gray-100"><tr><th class="px-2 py-2">ê³¼ì„¸í‘œì¤€ (ì—° ì†Œë“)</th><th class="px-2 py-2 text-right">ì„¸ìœ¨</th><th class="px-2 py-2 text-right">ëˆ„ì§„ê³µì œì•¡</th></tr></thead><tbody id="taxTableBody"></tbody></table></div>
            </div>
        </div>
    </div>

    <script>
        // --- Core Utils ---
        function getNumber(val) { return typeof val === 'string' ? Number(val.replace(/[^0-9.]/g, '')) || 0 : val; }
        function formatNumber(num) { return Math.round(num).toLocaleString(); }
        function ceilToThousand(num) { return Math.ceil(num / 1000) * 1000; }

        // --- Event Listener (Real-time formatting) ---
        document.addEventListener('input', function(e) {
            if (e.target.matches('.calc-trigger')) {
                if (e.target.id !== 'loanRate') {
                    if (!e.target.value.endsWith('.')) {
                        let raw = e.target.value.replace(/[^0-9.]/g, '');
                        if (raw) e.target.value = Number(raw).toLocaleString();
                    }
                }
                runCalculationInternal(); 
            }
        });

        // --- Logic: Show Result ---
        function showResult() {
            runCalculationInternal(); // Ensure latest data
            const box = document.getElementById('resultBox');
            box.classList.remove('hidden');
            // ëª¨ë°”ì¼ì—ì„œ ê²°ê³¼ì°½ì´ ë” ì˜ ë³´ì´ë„ë¡ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ì¡°ì •
            setTimeout(() => {
                box.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);
        }

        function runCalculationInternal() {
            // 1. Tax Logic
            const monthlyTargetNet = getNumber(document.getElementById('targetProfit').value);
            const annualTargetNet = monthlyTargetNet * 12;
            const taxCalc = calculatePreTaxIncome(annualTargetNet);
            const monthlyPreTaxProfit = taxCalc.gross / 12;
            const monthlyIncomeTax = monthlyPreTaxProfit - monthlyTargetNet;

            document.getElementById('displayAnnualIncome').innerText = formatNumber(annualTargetNet) + " ì›";
            document.getElementById('displayTaxBracket').innerText = taxCalc.bracket;

            // 2. Fixed Costs
            const rent = getNumber(document.getElementById('rent').value) / 1.1;
            const misc = getNumber(document.getElementById('misc').value) / 1.1;

            // 3. Labor Logic
            const laborData = calculateLabor();
            
            // 4. Finance Logic
            const principal = getNumber(document.getElementById('loanPrincipal').value);
            const rate = parseFloat(document.getElementById('loanRate').value) || 0;
            const interest = (principal * (rate / 100)) / 12;
            document.getElementById('monthlyInterestDisplay').innerText = formatNumber(interest) + "ì›";

            // 5. Totals
            const totalFixedCost = rent + misc + laborData.total + interest;
            const requiredContribution = monthlyPreTaxProfit + totalFixedCost;

            // 6. Revenue Goal (Calculated on Supply Price then VAT added)
            const mixData = calculateMix();
            let revenueSupply = 0;
            let revenueVAT = 0;
            let requiredRevenueTotal = 0;

            if (mixData.weightedMargin > 0) {
                revenueSupply = requiredContribution / mixData.weightedMargin;
                revenueVAT = revenueSupply * 0.1;
                requiredRevenueTotal = ceilToThousand(revenueSupply + revenueVAT);
            }

            // 7. Render Result Box
            document.getElementById('resTargetNet').innerText = formatNumber(monthlyTargetNet) + " ì›";
            document.getElementById('resIncomeTax').innerText = "+ " + formatNumber(monthlyIncomeTax) + " ì›";
            document.getElementById('resPreTaxProfit').innerText = formatNumber(monthlyPreTaxProfit) + " ì›";
            document.getElementById('resBasicFixed').innerText = formatNumber(rent+misc) + " ì›";
            document.getElementById('resLaborBase').innerText = formatNumber(laborData.base) + " ì›";
            document.getElementById('resLaborInsurance').innerText = "+ " + formatNumber(laborData.insurance) + " ì›";
            document.getElementById('resFinanceFixed').innerText = formatNumber(interest) + " ì›";
            document.getElementById('resContribution').innerText = "= " + formatNumber(requiredContribution) + " ì›";
            
            // VAT Breakdown Display
            document.getElementById('resRevenueSupply').innerText = formatNumber(revenueSupply) + " ì›";
            document.getElementById('resRevenueVAT').innerText = "+ " + formatNumber(revenueVAT) + " ì›";
            document.getElementById('resTotalRevenue').innerText = formatNumber(requiredRevenueTotal) + " ì›";

            renderDailyTargets(mixData.products, requiredRevenueTotal);
        }

        // --- Sub-Logics ---
        function calculateLabor() {
            let totalCost = 0, totalBase = 0, totalInsurance = 0;
            const insuranceRate = 0.107; // 10.7% Fixed
            const rows = document.querySelectorAll('#laborBody tr');
            rows.forEach((row) => {
                const inputs = row.querySelectorAll('input');
                const salary = getNumber(inputs[1].value);
                const count = Number(inputs[2].value) || 0;
                
                let costPerPerson = salary * (1 + insuranceRate);
                totalInsurance += (salary * insuranceRate) * count;
                totalBase += salary * count;
                totalCost += costPerPerson * count;
            });
            document.getElementById('displayBaseSalary').innerText = formatNumber(totalBase) + "ì›";
            document.getElementById('displayInsurance').innerText = "+ " + formatNumber(totalInsurance) + "ì›";
            document.getElementById('totalLaborPreview').innerText = formatNumber(totalCost) + "ì›";
            return { total: totalCost, base: totalBase, insurance: totalInsurance };
        }

        function calculateMix() {
            const productRows = document.querySelectorAll('#productBody tr');
            let weightedMarginSum = 0, totalMixPercent = 0, products = [];
            productRows.forEach(row => {
                const inputs = row.querySelectorAll('input');
                const name = inputs[0].value || "ë¯¸ì§€ì •";
                const price = getNumber(inputs[1].value);
                const cost = getNumber(inputs[2].value);
                const mix = Number(inputs[3].value) || 0;
                if (price > 0) {
                    const priceSupply = price / 1.1;
                    const costSupply = cost / 1.1;
                    const marginRate = (priceSupply - costSupply) / priceSupply;
                    weightedMarginSum += marginRate * (mix / 100);
                    totalMixPercent += mix;
                    products.push({ name, price, mix });
                }
            });
            const display = document.getElementById('mixTotalDisplay');
            display.innerText = totalMixPercent + "%";
            display.className = totalMixPercent !== 100 ? "text-sm font-bold text-red-600" : "text-sm font-bold text-green-600";
            return { weightedMargin: weightedMarginSum / (totalMixPercent/100), products };
        }

        function renderDailyTargets(products, totalRevenue) {
            const container = document.getElementById('dailyTargets');
            container.innerHTML = "";
            products.forEach(p => {
                const itemMonthlyRev = totalRevenue * (p.mix / 100);
                const itemDailyQty = (itemMonthlyRev / p.price) / 25;
                const div = document.createElement('div');
                div.className = "flex justify-between items-center p-3 bg-white border border-gray-200 rounded-md shadow-sm";
                div.innerHTML = `<div class="flex items-center space-x-2"><div class="text-xs font-bold text-gray-400 w-8">${p.mix}%</div><div class="text-sm font-medium text-gray-900">${p.name}</div></div><div class="text-right"><span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-bold bg-indigo-100 text-indigo-800">í•˜ë£¨ ${itemDailyQty.toFixed(1)}ê°œ</span></div>`;
                container.appendChild(div);
            });
        }

        // --- Tax & Modal ---
        const taxBrackets = [{limit:14000000,rate:0.06,deduction:0},{limit:50000000,rate:0.15,deduction:1260000},{limit:88000000,rate:0.24,deduction:5760000},{limit:150000000,rate:0.35,deduction:15440000},{limit:300000000,rate:0.38,deduction:19940000},{limit:500000000,rate:0.40,deduction:25940000},{limit:1000000000,rate:0.42,deduction:35940000},{limit:Infinity,rate:0.45,deduction:65940000}];
        function calculatePreTaxIncome(annualNetTarget) {
            for (let i=0; i<taxBrackets.length; i++) {
                const b = taxBrackets[i];
                const estimatedGross = (annualNetTarget - b.deduction)/(1-b.rate);
                const prevLimit = (i===0)?0:taxBrackets[i-1].limit;
                if (estimatedGross>prevLimit && estimatedGross<=b.limit) return {gross:estimatedGross, bracket:`${(b.rate*100)}% êµ¬ê°„`};
            }
            const lastB = taxBrackets[taxBrackets.length-1];
            return {gross:(annualNetTarget-lastB.deduction)/(1-lastB.rate), bracket:"45% êµ¬ê°„"};
        }
        function toggleModal() { document.querySelector('body').classList.toggle('modal-active'); document.getElementById('taxModal').classList.toggle('opacity-0'); document.getElementById('taxModal').classList.toggle('pointer-events-none'); }
        const tb = document.getElementById('taxTableBody');
        taxBrackets.forEach((b,i) => {
            let t = (i===0)?"1,400ë§Œì› ì´í•˜":(i===taxBrackets.length-1)?"10ì–µì› ì´ˆê³¼":`${formatNumber(taxBrackets[i-1].limit/10000)}ë§Œ ~ ${formatNumber(b.limit/10000)}ë§Œ`;
            tb.innerHTML += `<tr class="border-b"><td class="px-2 py-2">${t}</td><td class="px-2 py-2 text-right">${b.rate*100}%</td><td class="px-2 py-2 text-right">${formatNumber(b.deduction)}</td></tr>`;
        });

        function addLaborRow() {
            const tbody = document.getElementById('laborBody');
            const newRow = document.createElement('tr');
            newRow.innerHTML = `<td class="py-2"><input type="text" placeholder="ì§ê¸‰" class="w-full border-0 p-0 text-gray-900 text-sm font-medium"></td><td class="py-2"><input type="text" placeholder="0" class="input-currency w-full border-0 p-0 text-gray-900 text-sm bg-gray-50 rounded px-2 text-right calc-trigger"></td><td class="py-2"><input type="number" value="1" class="w-full border-0 p-0 text-gray-900 text-sm bg-gray-50 rounded px-2 text-right calc-trigger"></td><td class="text-right"><button onclick="removeRow(this)" class="text-gray-300 hover:text-red-500">Ã—</button></td>`;
            tbody.appendChild(newRow);
            runCalculationInternal();
        }
        function addProductRow() {
            const tbody = document.getElementById('productBody');
            const newRow = document.createElement('tr');
            newRow.innerHTML = `<td class="py-3 pr-2"><input type="text" placeholder="ìƒí’ˆëª…" class="w-full border-0 p-0 text-gray-900 font-medium"></td><td class="py-3 px-1"><input type="text" placeholder="0" class="input-currency w-full border-0 p-0 text-gray-900 bg-blue-50 rounded px-1 text-right calc-trigger"></td><td class="py-3 px-1"><input type="text" placeholder="0" class="input-currency w-full border-0 p-0 text-gray-900 bg-red-50 rounded px-1 text-right calc-trigger"></td><td class="py-3 pl-2"><input type="number" placeholder="0" class="mix-percent w-full border-0 p-0 text-indigo-700 font-bold bg-gray-100 rounded px-1 text-right calc-trigger"></td><td class="text-right"><button onclick="removeRow(this)" class="text-gray-300 hover:text-red-500">Ã—</button></td>`;
            tbody.appendChild(newRow);
            runCalculationInternal();
        }
        function removeRow(btn) { btn.closest('tr').remove(); runCalculationInternal(); }

        // Initial run
        runCalculationInternal();
    </script>
</body>
</html>
